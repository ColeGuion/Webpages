<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Maker</title>
    <link rel="stylesheet" href="Style/DataMaker.css">
    <style>
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- <h1>Dual Text Processor</h1> -->
        <div class="input-row">
            <div class="input-group">
                <!-- <label for="dtype">DType</label> -->
                <div class="input-wrapper">
                    <input type="text" id="dtype" list="dtype-list" placeholder="DTYPE" oninput="togglePhonesSection()">
                    <datalist id="dtype-list"></datalist>
                    <button class="clear-btn" onclick="clearInput('dtype')" title="Clear dtype">Ã—</button>
                </div>
            </div>
            <div class="input-group">
                <!-- <label for="source">Source</label> -->
                <div class="input-wrapper">
                    <input type="text" id="source" placeholder="SOURCE">
                    <button class="clear-btn" onclick="clearInput('source')" title="Clear source">Ã—</button>
                </div>
            </div>
        </div>

        <div id="phones-section" class="input-row hidden">
            <div class="input-group">
                <div class="input-wrapper">
                    <input type="text" id="phone1" placeholder="PHONE #1">
                    <button class="clear-btn" onclick="clearInput('phone1')" title="Clear phone 1">Ã—</button>
                </div>
            </div>
            <div class="input-group">
                <div class="input-wrapper">
                    <input type="text" id="phone2" placeholder="PHONE #2">
                    <button class="clear-btn" onclick="clearInput('phone2')" title="Clear phone 2">Ã—</button>
                </div>
            </div>
            <div class="input-group">
                <div class="input-wrapper">
                    <input type="text" id="phone3" placeholder="PHONE #3">
                    <button class="clear-btn" onclick="clearInput('phone3')" title="Clear phone 3">Ã—</button>
                </div>
            </div>
        </div>

        <div class="button-container" style="margin-bottom: 16px;">
            <div class="button-row">
                <button class="action-btn remove-empties" onclick="removeEmptyLines()">Strip Whitespace</button>
                <button class="action-btn remove-quotes" onclick="removeQuotes()">Remove Quotes</button>
                <button class="action-btn remove-numbers" onclick="removeNumbers()">Remove Numbers</button>
                <!-- <button class="action-btn replace-apostrophe" onclick="replaceApostrophes()">Replace Apostrophes</button> --> <!-- Done automatically -->
                <button class="action-btn combine-sents" onclick="combineToSentences()">Combine To Sentences</button>
            </div>
        </div>

        <div class="textbox-container">
            <div class="textbox-group">
                <div class="textbox-header">
                    <label for="textbox1">Input</label>
                    <!-- <div class="textbox-buttons"><button class="textarea-copy-btn" onclick="copyTextarea('textbox1')" title="Copy text">ðŸ“‹ Copy</button> <button class="textarea-clear-btn" onclick="clearTextarea('textbox1')" title="Clear text">Ã— Clear</button></div> -->
                </div>
                <div class="textbox-wrapper">
                    <div class="textarea-container">
                        <div class="line-numbers" id="line-numbers-1"></div>
                        <textarea id="textbox1" oninput="updateLineNumbers('textbox1', 'line-numbers-1')" onscroll="syncScroll('textbox1', 'line-numbers-1')" onpaste="handlePaste('textbox1')"></textarea>
                    </div>
                </div>
                <div class="textbox-footer">
                    <button class="textarea-copy-btn" onclick="copyTextarea('textbox1')" title="Copy text">ðŸ“‹ Copy</button>
                    <button class="textarea-clear-btn" onclick="clearTextarea('textbox1')" title="Clear text">Ã— Clear</button>
                </div>
            </div>
            <div class="textbox-group">
                <div class="textbox-header">
                    <label for="textbox2">Corrected</label>
                </div>
                <div class="textbox-wrapper">
                    <div class="textarea-container">
                        <div class="line-numbers" id="line-numbers-2"></div>
                        <textarea id="textbox2" oninput="updateLineNumbers('textbox2', 'line-numbers-2')" onscroll="syncScroll('textbox2', 'line-numbers-2')" onpaste="handlePaste('textbox2')"></textarea>
                    </div> 
                </div>
                <div class="textbox-footer">
                    <button class="textarea-copy-btn" onclick="copyTextarea('textbox2')" title="Copy text">ðŸ“‹ Copy</button>
                    <button class="textarea-clear-btn" onclick="clearTextarea('textbox2')" title="Clear text">Ã— Clear</button>
                </div>
            </div>
        </div>

        <div class="button-container">
            <div class="button-row submit-row">
                <button class="action-btn submit-btn" onclick="submitData()">Submit Data</button>
            </div>
        </div>

        <div id="result-container" style="display: none; margin-top: 30px;">
            <h2 id="result-objects-header" style="color: #333; margin-bottom: 15px; text-align: center;">Generated JSON Objects</h2>
            <div style="position: relative;">
                <pre id="result-display" style="background: rgba(0, 0, 0, 0.05); padding: 20px; border-radius: 10px; font-family: 'Courier New', monospace; font-size: 14px; line-height: 1.6; max-height: 400px; overflow-y: auto; border: 2px solid #e0e0e0;"></pre>
                <button class="action-btn" onclick="copyResult()" style="position: absolute; top: 10px; right: 30px; padding: 8px 16px; font-size: 12px; min-width: auto; background: linear-gradient(45deg, #667eea, #764ba2);">
                    ðŸ“‹ Copy JSON
                </button>
            </div>
        </div>
    </div>

    <!-- TODO: Have AI clean this up -->
    <!-- TODO: Add bigger space between different lines, but not the same line that is wrapped -->
    <script src="Scripts/DataMaker.js"></script>
    <script> 
        const dtypeInput = document.getElementById('dtype');
        const phoneInp1 = document.getElementById('phone1');
        const phoneInp2 = document.getElementById('phone2');
        const phoneInp3 = document.getElementById('phone3');
        // Select all text in dtype input on focus
        dtypeInput.addEventListener('focus', function(e) {
            e.target.select();
        });
        phoneInp1.addEventListener('focus', function(e) {
            e.target.select();
        });
        phoneInp2.addEventListener('focus', function(e) {
            e.target.select();
        });
        phoneInp3.addEventListener('focus', function(e) {
            e.target.select();
        });

        // Auto capitalize text in homophones input boxes
        phoneInp1.addEventListener('input', function(e) {
            e.target.value = e.target.value.toUpperCase();
        });
        phoneInp2.addEventListener('input', function(e) {
            e.target.value = e.target.value.toUpperCase();
        });
        phoneInp3.addEventListener('input', function(e) {
            e.target.value = e.target.value.toUpperCase();
        });

        
        function togglePhonesSect() {
            if (dtypeInput.value.trim().toLowerCase() === 'homophones') {
                document.getElementById('phones-section').classList.remove('hidden');
            } else {
                document.getElementById('phones-section').classList.add('hidden');
                // Clear phones inputs when hiding
                phoneInp1.value = '';
                phoneInp2.value = '';
                phoneInp3.value = '';
            }
        }

        // Remove quotes from dtype input as user types or pastes
        function removeQuotesFromDtype(e) {
            const oldValue = e.target.value;
            const newValue = oldValue.replace(/["']/g, '');
            if (oldValue !== newValue) {
                e.target.value = newValue;
            }
        }
        dtypeInput.addEventListener('input', removeQuotesFromDtype);
        dtypeInput.addEventListener('paste', function(e) {
            e.preventDefault();
            let paste = (e.clipboardData || window.clipboardData).getData('text');
            paste = paste.replace(/["']/g, '');
            const start = dtypeInput.selectionStart;
            const end = dtypeInput.selectionEnd;
            const value = dtypeInput.value;
            dtypeInput.value = value.slice(0, start) + paste + value.slice(end);
            // Move cursor to end of pasted text
            dtypeInput.selectionStart = dtypeInput.selectionEnd = start + paste.length;
        });

        dtypeInput.addEventListener('focus', togglePhonesSect);
        dtypeInput.addEventListener('select', togglePhonesSect);


        /* // Custom double-click selection for textareas
        function selectWordNoSpace(e) {
            const textarea = e.target;
            const value = textarea.value;
            const pos = textarea.selectionStart;
            // Find word boundaries
            let start = pos, end = pos;
            while (start > 0 && /\w/.test(value[start - 1])) start--;
            while (end < value.length && /\w/.test(value[end])) end++;
            // Set selection range to just the word
            textarea.setSelectionRange(start, end);
            e.preventDefault();
        }
        document.getElementById('textbox1').addEventListener('dblclick', selectWordNoSpace);
        document.getElementById('textbox2').addEventListener('dblclick', selectWordNoSpace); */
    </script>
    <script src="Scripts/navigation.js"></script>
</body>
</html>