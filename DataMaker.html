<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Maker</title>
    <script src="Scripts/navigation.js"></script>
    <link rel="stylesheet" href="Style/DataMaker.css">
    <style></style>
</head>
<body>
    <div class="container">
        <div class="input-container">
            <!-- DType and Source -->
            <div class="input-row">
                <div class="input-group" style="flex: 3;">
                    <div class="input-wrapper">
                        <input type="text" id="dtype" list="dtype-list" placeholder="DTYPE" oninput="toggleSections();">
                        <datalist id="dtype-list"></datalist>
                        <button class="clear-btn" onclick="clearInput('dtype')" title="Clear dtype" tabindex="-1">Ã—</button>
                    </div>
                </div>
                <div class="input-group">
                    <div class="input-wrapper">
                        <input type="text" id="source" placeholder="SOURCE">
                        <button class="clear-btn" onclick="clearInput('source')" title="Clear source" tabindex="-1">Ã—</button>
                    </div>
                </div>
            </div>

            <!-- Homophones -->
            <div id="phones-section" class="input-row hidden">
                <div class="input-group">
                    <div class="input-wrapper">
                        <input type="text" id="phone1" class="phone-inp" list="homophone-list" placeholder="PHONE #1">
                        <button class="clear-btn" onclick="clearInput('phone1')" title="Clear phone 1" tabindex="-1">Ã—</button>
                    </div>
                </div>
                <div class="input-group">
                    <div class="input-wrapper">
                        <input type="text" id="phone2" class="phone-inp" list="homophone-list" placeholder="PHONE #2">
                        <button class="clear-btn" onclick="clearInput('phone2')" title="Clear phone 2" tabindex="-1">Ã—</button>
                    </div>
                </div>
                <div class="input-group">
                    <div class="input-wrapper">
                        <input type="text" id="phone3" class="phone-inp" list="homophone-list" placeholder="PHONE #3">
                        <button class="clear-btn" onclick="clearInput('phone3')" title="Clear phone 3" tabindex="-1">Ã—</button>
                    </div>
                </div>
                <datalist id="homophone-list">
                    <option value="Capital">Capital</option>
                    <option value="Capitol">Capitol</option>
                    <option value="Bear">Bear</option>
                    <option value="Bare">Bare</option>
                    <option value="Peak">Peak</option>
                    <option value="Peek">Peek</option>
                    <option value="Pique">Pique</option>
                    <option value="Except">Except</option>
                    <option value="Accept">Accept</option>
                    <option value="Compliment">Compliment</option>
                    <option value="Complement">Complement</option>
                    <option value="Every day">Every day</option>
                    <option value="Everyday">Everyday</option>
                    <option value="Especially">Especially</option>
                    <option value="Specially">Specially</option>
                    <option value="Rein">Rein</option>
                    <option value="Reign">Reign</option>
                    <option value="Rain">Rain</option>
                    <option value="Bite">Bite</option>
                    <option value="Byte">Byte</option>
                    <option value="Vane">Vane</option>
                    <option value="Vein">Vein</option>
                    <option value="Vain">Vain</option>
                    <option value="Pore">Pore</option>
                    <option value="Poor">Poor</option>
                    <option value="Pour">Pour</option>
                    <option value="Lay">Lay</option>
                    <option value="Lie">Lie</option>
                    <option value="Weather">Weather</option>
                    <option value="Wether">Wether</option>
                    <option value="Marry">Marry</option>
                    <option value="Merry">Merry</option>
                </datalist>
            </div>

            <!-- Date Formatting Tags -->
            <div id="date-formats-section" class="input-row hidden">
                <div class="input-group">
                    <div class="input-wrapper">
                        <input type="text" id="dateTag1" class="dateTag-inp" list="dateTag-list" placeholder="DATE TAG">
                        <button class="clear-btn" onclick="clearInput('dateTag1')" title="Clear" tabindex="-1">Ã—</button>
                    </div>
                </div>
                <div class="input-group">
                    <div class="input-wrapper">
                        <input type="text" id="dateTag2" class="dateTag-inp" list="dateTag-list" placeholder="DATE TAG">
                        <button class="clear-btn" onclick="clearInput('dateTag2')" title="Clear" tabindex="-1">Ã—</button>
                    </div>
                </div>
                <div class="input-group">
                    <div class="input-wrapper">
                        <input type="text" id="dateTag3" class="dateTag-inp" list="dateTag-list" placeholder="DATE TAG">
                        <button class="clear-btn" onclick="clearInput('dateTag3')" title="Clear" tabindex="-1">Ã—</button>
                    </div>
                </div>
                <datalist id="dateTag-list">
                    <option value="British Dates">British Dates</option>
                    <option value="Date Ranges">Date Ranges</option>
                    <option value="Month Abbreviations">Month Abbreviations</option>
                    <option value="Numerical Dates">Numerical Dates</option>
                    <option value="Ordinal Dates">Ordinal Dates</option>
                    <option value="MONTH DAY">MONTH DAY</option>
                    <option value="MONTH DAY, YEAR">MONTH DAY, YEAR</option>
                    <option value="WEEKDAY, DATE">WEEKDAY, DATE</option>
                </datalist>
            </div>
        </div>

        <div class="button-container" style="margin: 15px 0;">
            <div class="button-row">
                <button class="action-btn remove-empties" onclick="removeEmptyLines()">Strip Whitespace</button>
                <button class="action-btn remove-quotes" onclick="removeQuotes()">Remove Quotes</button>
                <button class="action-btn remove-numbers" onclick="removeNumbers()">Remove Numbers</button>
                <button class="action-btn remove-dashes" onclick="removeDashes()">Remove Dashes</button>
                <!-- <button class="action-btn replace-apostrophe" onclick="replaceApostrophes()">Replace Apostrophes</button> --> <!-- Done automatically -->
                <button class="action-btn combine-sents" onclick="combineToSentences()">Combine To Sentences</button>
            </div>
        </div>

        <div class="textbox-container">
            <div class="textbox-group">
                <div class="textbox-header">
                    <label for="textbox1">Input</label>
                    <!-- <div class="textbox-buttons"><button class="textarea-copy-btn" onclick="copyTextarea('textbox1')" title="Copy text">ðŸ“‹ Copy</button> <button class="textarea-clear-btn" onclick="clearTextarea('textbox1')" title="Clear text">Ã— Clear</button></div> -->
                </div>
                <div class="textbox-wrapper">
                    <div class="textarea-container">
                        <div class="line-numbers" id="line-numbers-1"></div>
                        <textarea id="textbox1" oninput="updateLineNumbers('textbox1', 'line-numbers-1')" onscroll="syncScroll('textbox1', 'line-numbers-1')" onpaste="handlePaste('textbox1')"></textarea>
                    </div>
                    <div class="find-replace-panel hidden" id="find-replace-panel-1">
                        <input type="text" id="find-text-1" placeholder="Find (case-sensitive)">
                        <input type="text" id="replace-text-1" placeholder="Replace with">
                        <button class="fr-btn" onclick="runFindReplace('textbox1', 'find-text-1', 'replace-text-1')">Replace All</button>
                    </div>
                </div>
                <div class="textbox-footer">
                    <button class="textarea-copy-btn" onclick="copyTextarea('textbox1')" title="Copy text">ðŸ“‹ Copy</button>
                    <button class="textarea-clear-btn" onclick="clearTextarea('textbox1')" title="Clear text">Ã— Clear</button>
                    <button class="textarea-opt-btn" onclick="toggleFindReplace(1)" title="Find & Replace">ðŸ”Ž Find/Replace</button>
                </div>
            </div>
            <div class="textbox-group">
                <div class="textbox-header">
                    <label for="textbox2">Corrected</label>
                </div>
                <div class="textbox-wrapper">
                    <div class="textarea-container">
                        <div class="line-numbers" id="line-numbers-2"></div>
                        <textarea id="textbox2" oninput="updateLineNumbers('textbox2', 'line-numbers-2')" onscroll="syncScroll('textbox2', 'line-numbers-2')" onpaste="handlePaste('textbox2')"></textarea>
                    </div> 
                    <div class="find-replace-panel hidden" id="find-replace-panel-2">
                        <input type="text" id="find-text-2" placeholder="Find (case-sensitive)">
                        <input type="text" id="replace-text-2" placeholder="Replace with">
                        <button class="fr-btn" onclick="runFindReplace('textbox2', 'find-text-2', 'replace-text-2')">Replace All</button>
                    </div>
                </div>
                <div class="textbox-footer">
                    <button class="textarea-copy-btn" onclick="copyTextarea('textbox2')" title="Copy text">ðŸ“‹ Copy</button>
                    <button class="textarea-clear-btn" onclick="clearTextarea('textbox2')" title="Clear text">Ã— Clear</button>
                    <button class="textarea-opt-btn" onclick="toggleFindReplace(2)" title="Find & Replace">ðŸ”Ž Find/Replace</button>
                </div>
            </div>
        </div>

        <div class="button-container">
            <div class="button-row submit-row">
                <button class="action-btn submit-btn" onclick="submitData()">Submit Data</button>
            </div>
        </div>

        <div id="result-container">
            <h2 id="result-objects-header">Generated JSON Objects</h2>
            <div style="position: relative;">
                <pre id="result-display"></pre>
                <button class="action-btn" onclick="copyResult()" style="position: absolute; top: 10px; right: 30px; padding: 8px 16px; font-size: 12px; min-width: auto; background: linear-gradient(45deg, #667eea, #764ba2);">
                    ðŸ“‹ Copy JSON
                </button>
            </div>
        </div>
    </div>

    <!-- TODO: Have AI clean this up -->
    <!-- TODO: Add bigger space between different lines, but not the same line that is wrapped -->
    <script src="Scripts/DataMaker.js"></script>
    <script> 
        const dtypeInput = document.getElementById('dtype');
        // Select entire text on focus
        dtypeInput.addEventListener('focus', function(e) {
            e.target.select();
        });
        // Capitalize each word as user types in dtype input
        dtypeInput.addEventListener('input', function(e) {
            // Only run if not caused by programmatic value change
            if (document.activeElement !== dtypeInput) return;
            let value = dtypeInput.value;
            // Capitalize each word
            value = value.replace(/\b\w+/g, function(word) {
                return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
            });
            if (dtypeInput.value !== value) {
                const start = dtypeInput.selectionStart;
                const end = dtypeInput.selectionEnd;
                dtypeInput.value = value;
                dtypeInput.setSelectionRange(start, end);
            }
        });
        document.querySelectorAll('.phone-inp').forEach(phoneInput => {
            // Select entire text on focus
            phoneInput.addEventListener('focus', e => e.target.select());

            // Auto capitalize text in homophones input boxes
            phoneInput.addEventListener('input', function(e) {
                e.target.value = e.target.value.toUpperCase();
            });
        });
        
        function toggleSections() {
            console.log("Toggling Sections");
            // Homophones
            if (dtypeInput.value.trim().toLowerCase() === 'homophones') {
                document.getElementById('phones-section').classList.remove('hidden');
            } else {
                document.getElementById('phones-section').classList.add('hidden');
                // Clear phones inputs when hiding
                document.getElementById('phone1').value = '';
                document.getElementById('phone2').value = '';
                document.getElementById('phone3').value = '';
            }

            // Date Formatting Tags
            if (dtypeInput.value.trim().toLowerCase() === 'date formatting') {
                document.getElementById('date-formats-section').classList.remove('hidden');
            } else {
                document.getElementById('date-formats-section').classList.add('hidden');
                // Clear inputs when hiding
                document.getElementById('dateTag1').value = '';
                document.getElementById('dateTag2').value = '';
                document.getElementById('dateTag3').value = '';
            }
        }


        // Remove quotes from dtype input as user types or pastes
        function removeQuotesFromDtype(e) {
            const oldValue = e.target.value;
            const newValue = oldValue.replace(/["']/g, '');
            if (oldValue !== newValue) {
                e.target.value = newValue;
            }
        }
        dtypeInput.addEventListener('input', removeQuotesFromDtype);
        dtypeInput.addEventListener('paste', function(e) {
            e.preventDefault();
            let paste = (e.clipboardData || window.clipboardData).getData('text');
            paste = paste.replace(/["']/g, '');
            const start = dtypeInput.selectionStart;
            const end = dtypeInput.selectionEnd;
            const value = dtypeInput.value;
            dtypeInput.value = value.slice(0, start) + paste + value.slice(end);
            // Move cursor to end of pasted text
            dtypeInput.selectionStart = dtypeInput.selectionEnd = start + paste.length;
        });

        dtypeInput.addEventListener('focus', toggleSections);
        dtypeInput.addEventListener('select', toggleSections);


        /* // Custom double-click selection for textareas
        function selectWordNoSpace(e) {
            const textarea = e.target;
            const value = textarea.value;
            const pos = textarea.selectionStart;
            // Find word boundaries
            let start = pos, end = pos;
            while (start > 0 && /\w/.test(value[start - 1])) start--;
            while (end < value.length && /\w/.test(value[end])) end++;
            // Set selection range to just the word
            textarea.setSelectionRange(start, end);
            e.preventDefault();
        }
        document.getElementById('textbox1').addEventListener('dblclick', selectWordNoSpace);
        document.getElementById('textbox2').addEventListener('dblclick', selectWordNoSpace); */
    </script>
</body>
</html>