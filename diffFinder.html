<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>String Difference Finder</title>
    <link rel="stylesheet" href="Style/diffFinder.css">
    <style>
    </style>
</head>
<body>
    <div class="main-content">
    <div class="container">
        <div class="header">
            <h1>üîç String Difference Finder</h1>
            <p>Compare two strings and find their differences</p>
        </div>
        
        <div class="content">
            <div class="input-group">
                <label for="string1">First String:</label>
                <textarea 
                    id="string1" 
                    placeholder="Enter your first string here..."
                >Hello World!</textarea>
            </div>
            
            <div class="input-group">
                <label for="string2">Second String:</label>
                <textarea 
                    id="string2" 
                    placeholder="Enter your second string here..."
                >Hello Netlify!</textarea>
            </div>
            
            <div class="button-group">
                <button id="findDiffBtn">Find Differences</button>
            </div>
            
            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <p>Finding differences...</p>
            </div>
            
            <div id="error" class="error hidden"></div>
            
            <div id="resultContainer" class="result-container hidden">
                <div class="result-title">Differences Found:</div>
                <ul id="resultList" class="result-list"></ul>
            </div>
        </div>
    </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const findDiffBtn = document.getElementById('findDiffBtn');
            const string1Input = document.getElementById('string1');
            const string2Input = document.getElementById('string2');
            const loadingElement = document.getElementById('loading');
            const errorElement = document.getElementById('error');
            const resultContainer = document.getElementById('resultContainer');
            const resultList = document.getElementById('resultList');

            findDiffBtn.addEventListener('click', async function() {
                const string1 = string1Input.value.trim();
                const string2 = string2Input.value.trim();

                // Basic validation
                if (!string1 || !string2) {
                    showError('Please enter both strings');
                    return;
                }

                // Show loading state
                setLoading(true);
                hideError();
                hideResult();

                try {
                    // Call the Netlify function
                    const response = await fetch('/.netlify/functions/finddiff', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            string1: string1,
                            string2: string2
                        })
                    });

                    const data = await response.json();

                    if (!response.ok) {
                        throw new Error(data.error || 'Something went wrong');
                    }

                    // Display results
                    console.log("Data received:", data);
                    displayResults(data.result);

                } catch (error) {
                    showError(error.message);
                } finally {
                    setLoading(false);
                }
            });

            function setLoading(isLoading) {
                if (isLoading) {
                    loadingElement.classList.remove('hidden');
                    findDiffBtn.disabled = true;
                    findDiffBtn.textContent = 'Processing...';
                } else {
                    loadingElement.classList.add('hidden');
                    findDiffBtn.disabled = false;
                    findDiffBtn.textContent = 'Find Differences';
                }
            }

            function showError(message) {
                errorElement.textContent = message;
                errorElement.classList.remove('hidden');
            }

            function hideError() {
                errorElement.classList.add('hidden');
            }

            function displayResults(differences) {
                resultList.innerHTML = '';
                
                if (differences && differences.length > 0) {
                    differences.forEach(diff => {
                        const li = document.createElement('li');
                        li.className = 'result-item';
                        li.textContent = diff;
                        resultList.appendChild(li);
                    });
                } else {
                    const li = document.createElement('li');
                    li.className = 'result-item';
                    li.textContent = 'No differences found';
                    resultList.appendChild(li);
                }
                
                resultContainer.classList.remove('hidden');
            }

            function hideResult() {
                resultContainer.classList.add('hidden');
            }

            // Add some example text for quick testing
            string1Input.value = "Hello World!";
            string2Input.value = "Hello Netlify!";
        });
    </script>
    <script src="Scripts/navigation.js"></script>
</body>
</html>